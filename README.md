靜 宜 大 學

# 資 工 四 B 2020
A.專題名稱： 聞聲制物
  B.組員：
- 資工四B 410619368 黃偉恩 
- 資工四B 410616069 邱建逢
- 資工四B 410619740  張開
- 資工四B 410403458 吳旻玲

C.指導老師姓名：羅峻旗老師

D.成果報告書：成果報告書電子檔.pdf

E.程式：WenShengShiRen-master.zip

F.簡報：介紹專題PPT簡報檔.pptx
G.海報：專題海報檔
H.介紹影片：
- https://youtu.be/4AcjqRlLFLQ
## 聞聲制物使用手冊


## 目錄

- 1 使用情境
   - 1.1 直連以太網的公共網絡物聯網設備：以餐廳中的物聯網設備管理為例
   - 1.2 位於局域網內的設備：以互聯網公司管理系統為例
      - 設備為例 1.3 位於山區、自然保護區等網絡條件差的特殊物聯網監測設備：以移動式的氣象監測
- 2 Demo 程式的使用介紹
   - 2.1 程式的安裝與系統需求
   - 2.2 本地使用
      - 2.2.1 生成密碼.
      - 2.2.2 本地註冊.
      - 2.2.3 本地驗證.
   - 2.3 雲端使用
      - 2.3.1 系統佈置.
      - 2.3.2 註冊流程.
      - 2.3.3 雲端驗證.
- 3 與其他應用的接入方式
   - 3.1 連接智能家電
   - 3.2 連接員工簽到系統.
   - 3.3 置入iot設備本地驗證.
- 4 系統的限制與注意事項


## 1 使用情境

##### 因為我們系統可拆分可整合的特點，所以適用於多種使用情境，在此選取幾種有代表性的進行

##### 說明

### 1.1 直連以太網的公共網絡物聯網設備：以餐廳中的物聯網設備管理為例

##### 在具備無線網絡或是高強度的4G網絡環境中，系統採用雲端驗證的方式。在智能化餐廳中，

##### 有很多物聯網設備需要進行管理，服務員通過手機或是電子熒幕進行操作又顯得繁瑣。搭載了我

##### 們聞聲制物系統的物聯網設備只需要管理人員說一句口令，即可對其進行控制。管理人員說“把空

##### 調打開”餐廳內的空調即可開始運行，而顧客講相同的話卻不能開啟空調，聞聲制物系統實現了權

##### 限控管的功能。

### 1.2 位於局域網內的設備：以互聯網公司管理系統為例

##### 在公司局域網中，系統不具備以太網，我們則將資料庫與比對服務器架設與公司的局域網中，

##### 物聯網設備通過公司無線網絡接入局域網，保障資料安全只需要保護資料庫與比對服務器。公司

##### 員工到達單位後說了一聲“我要簽到”，打卡系統便知悉了員工的身份信息為他簽到。公司領導說

##### 了一聲“今天十點安排工作會議”，系統即刻識別出這個領導具有安排會議的權限，並創建了提醒，

##### 到時間便提醒員工參加會議。

### 1.3 位於山區、自然保護區等網絡條件差的特殊物聯網監測設備：以移動式的氣

### 象監測設備為例

在網絡條件差的情況下，我們使用NB-IoT模式連入物聯網。在只有微弱的4G信號覆蓋的山
區中，放置有昂貴的移動式氣象監測設備，科研人員需要投放大量設備對自然保護區中的氣候條件
進行研究。實驗設備價格昂貴，為了防止他人隨意碰觸，科研人員使用了聲紋鎖。設備採用鋰電池
供電，常年在低功耗環境下運行，科研人員先按了系統觸發按鈕，並說出“芝麻開門”，系統成功
認證後便為他打開了聲紋鎖。而有愛玩的小朋友去對著系統說“芝麻開門”系統卻毫無反應。

## 2 Demo 程式的使用介紹

### 2.1 程式的安裝與系統需求

我們的程式的所有代碼都是使用java開發，所以在linux、windows上都能提供服務，目前Demo
版具有前端界面，所以運行Demo的一級終端設備需要安裝基本的界面與聲音播放程式，同時搭載
麥克風與揚聲器提供輸入與輸出。
比對伺服器與資料庫則置於一般的linux服務器上即可，如需要將比對服務器架設在windows
主機上也可正常運作。
一級終端設備使用Demo版程式前，需要將專題中的FFmpeg文件夾與sound文件夾置於jar
文件同一目錄下，linux請使用apt-get手動安裝ffmpeg聲音轉換程式。
比對伺服器、一級終端、二級終端均需要安裝java jdk 1.8版本執行程式


##### 图1:生成密碼

後期如果有相關需求，我們將考慮將程式打包成exe或tar檔案，方便在各類系統中的安裝與
部署

### 2.2 本地使用

在已有的Demo程式下，我們有提供快速的本地聲紋確認技術，需要提供需要比對的使用者姓
名信息，模擬的是網絡條件有限的地區管理iot設備。

#### 2.2.1 生成密碼.

##### 程式的生成密碼模塊用於生成使用者說他的操作密語聲音特征對應的聲音密碼母本，以供之

##### 後進行比對。在我們的程式中，選擇生成密碼功能以使用。（圖 1 ）

##### 進入生成密碼模式後，程式不會停止運行，在輸入狀態欄位顯示保持安靜時，請務必保持環境

##### 安靜，程式會採集並計算環境聲音。在輸入狀態轉為請輸入時（圖 2 ），便需要請使用者講出聲音

##### 密碼。反復重複五次,在顯示採集完成後，程式會自動暫停，並語音提示輸入完成。

密碼生成完成後，程式會在作業系統的桌面或操作目錄下生成“cache0.txt與cache0.cav”文件，
方便使用者查看本次生成的聲音密碼母本與方便與管理系統銜接。

#### 2.2.2 本地註冊.

##### 生成密碼完成後程式自動暫停，以方便使用者進行本地註冊的操作。本地註冊時，需要在姓名

##### 欄位輸入使用者姓名，操作碼欄位輸入驗證成功後需要傳送給被控制設備的操作碼，並按下註冊按

##### 鈕。（圖 3 ）聽到系統反饋註冊成功後便完成了本地註冊的操作，程式會自動生成不加密的本地資

料庫“sql.csv”檔案，採用UTF-8編碼，方便使用者查看與更改本地資料庫。


##### 图2:生成密碼輸入狀態

##### 图3:註冊模塊

#### 2.2.3 本地驗證.

本地註冊成功存在sql.csv檔案後程式可以提供本地驗證服務。使用功能選單選擇本地驗證以
使用此服務。
啟動程式時，默認直接進入驗證狀態，若程式處於暫停狀態，按下開始按鈕以啟動驗證，若
demo結束後不需驗證，則可使用暫停按鈕，程式會停止驗證工作。
本地驗證目前為聲紋確認技術，需要手動于姓名欄位輸入註冊時提供的姓名信息。
啟動驗證後，程式輸入狀態變為保持安靜時，盡量不要發出過大的聲音，程式會自動計算環境
聲音，當聽到“叮”的語音提示後，便可以講出你的“通關密語”了。輸入完成後，程式會快速進
行比對並在相似度欄位中提供本此驗證的相似度數據，一般情況下80%以上的相似度視為驗證成
功，系統會有語音反饋，並執行相關指令。若輸入失敗也會有語音提示。本次驗證完成後系統將繼
續進入驗證狀態，計算環境聲音與等待使用者輸入聲音。

### 2.3 雲端使用

##### 在一般網絡情況下，系統採用分散式佈置並採用雲端驗證模式工作。

#### 2.3.1 系統佈置.

##### 雲端驗證工作模式下，系統部件分為資料庫、比對伺服器、一級終端（聲音的輸入與輸出）、

##### 二級終端（被控設備）。在演示環境中，我們將這些設備置於同一局域網中以避免連接外網的延遲。


```
图4:比對伺服器ip設置
```
```
在一般模式下，比對伺服器與資料庫應置於雲服務商提供的虛擬化伺服器中在比對伺服器程式中
設定資料庫的ip，並記錄比對伺服器ip，填寫於一級終端的界面中。（圖 4 ）
```
#### 2.3.2 註冊流程.

##### 程式在雲端使用時，註冊前仍需使用生成密碼功能生成聲音密碼母本。然後將生成的聲音密

```
碼母本cache.txt檔案中的內容寫入資料庫中的聲音密碼欄位，並填入使用者姓名與對應語音的內
容文字，以及驗證成功後發送給二級終端的操作碼。確定上傳到資料庫後註冊就完成了。
```
#### 2.3.3 雲端驗證.

##### 切換到雲端驗證模式以使用雲端驗證。使用者不需要填寫其他信息，等待系統輸入狀態切換

##### 到請輸入即可說話。停止說話後系統輸入狀態顯示輸入完成，會安裝程式流程進行聲紋辨認操作，

##### 大約3-5秒後會語音提示驗證結果，若為驗證成功，則會執行使用者的命令。

## 3 與其他應用的接入方式

##### 本認證系統使用需要連接其他硬件或軟件設備以發揮其功能，下面介紹幾種常見的連接模式。

### 3.1 連接智能家電

本系統驗證成功後會由一級終端（聲音輸入輸出設備）發送指定的json格式數據給二級終端
（受控端），若需要連接智能家電，只需要知道智能家電需要接收的指令格式即可，在程式內進行相
關的設置即可使用。


### 3.2 連接員工簽到系統.

##### 若需要連接到員工簽到系統實現語音一句話簽到功能，需要將員工的簽到指令與對應文字錄

入資料庫，並在操作碼欄位設定員工的id，在通過一級終端輸入語音信息並驗證成功後，系統會將
員工id發送給簽到系統，簽到系統需要接收員工id並進行相關的記錄統計動作。

### 3.3 置入iot設備本地驗證.

##### 若要在山區等網絡條件差的環境使用本系統的本地驗證模式使用本系統，可以將系統直接內

置於受控設備的作業系統中或外置于樹莓派等搭載linux系統的環境中，需要安裝java jdk8，並安
裝安裝說明進行相關的操作。
若需要內置於受控設備的作業系統中，程式需要根據受控設備程式的需求進行相關的調整。若
是為外置的，則可按照受控設備的命令要求，通過局域網向受控設備傳輸控制指令。
工作模式為本地驗證模式，需要搭配雲端管理系統去修改系統內置的sql.csv本地資料庫文件，
可通過藍牙、有線、iot網絡進行資料同步，文件大小一般為4-8KB，可快速同步。
使用本系統進行本地驗證控制iot設備時，需要提供比對的使用者姓名，此欄位的資料可以通
過刷卡認證（獲取RFID）或手動選擇等方式進行。本地驗證模式可以做到在1s內完成比對並執行
指令，擁有極高的工作效率。

## 4 系統的限制與注意事項

##### 1. 本系統的DEMO版本網絡傳輸資料沒有使用加密，僅供展示使用，需要投入實際使用應進行

##### 加密操作

##### 2. 在註冊與驗證時，務必準確清晰的說出你的驗證文字，若前後音調變化過大會影響比對準確

##### 度

##### 3. 本系統對於錄音攻擊還沒有完善的防備措施，後續版本會進行相關功能的探索

##### 4. 本系統終端設備之間發送的資料沒有簽章功能，容易受到中間人攻擊，若投入實際使用會完

##### 善相關功能

##### 5. 一級終端使用的麥克風需保證聲音未被內置聲卡預處理過，最大的保證錄入聲音的完整性

##### 6. 展示時一級終端設備配有顯示器，若實際投入使用則不需要畫面顯示


